// Reset t≈ô√≠d√≠c√≠ hry
        function resetClassificationGame() {
            usedClassificationQuestions.clear();
            classificationStats = { correct: 0, total: 0 }; // Reset statistik t≈ô√≠dƒõn√≠
            document.getElementById('classificationFeedback').classList.remove('active');
            
            // Najdi a zobraz tlaƒç√≠tko pro dal≈°√≠ ot√°zku
            const gameButtons = document.querySelectorAll('#classificationGame .btn');
            gameButtons.forEach(btn => {
                if (btn.textContent.includes('Dal≈°√≠ ot√°zka')) {
                    btn.style.display = 'inline-block';
                }
            });
            
            generateClassificationQuestion();
        }<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pokroƒçil√© materi√°lov√© in≈æen√Ωrstv√≠ - Interaktivn√≠ hry</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #ffd700;
        }
        
        .stat-label {
            font-size: 0.9em;
            opacity: 0.8;
        }
        
        .main-content {
            padding: 40px;
        }
        
        .game-menu {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .game-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }
        
        .game-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
            border-color: #667eea;
        }
        
        .game-card.classification {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
        }
        
        .game-card.properties {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
        }
        
        .game-card.selection {
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
        }
        
        .game-card h3 {
            font-size: 1.8em;
            margin-bottom: 15px;
            color: #333;
        }
        
        .game-card p {
            color: #666;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        
        .game-card .points {
            background: rgba(0,0,0,0.1);
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            color: #333;
            display: inline-block;
        }
        
        .game-area {
            display: none;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 40px;
            margin-top: 30px;
        }
        
        .game-area.active {
            display: block;
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .question-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .question-card h2 {
            font-size: 2.2em;
            margin-bottom: 15px;
        }
        
        .question-card .details {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: left;
        }
        
        .options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .option {
            background: white;
            border: 3px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .option:hover {
            border-color: #667eea;
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        
        .option.correct {
            border-color: #28a745;
            background: #d4edda;
        }
        
        .option.incorrect {
            border-color: #dc3545;
            background: #f8d7da;
        }
        
        .option.disabled {
            cursor: not-allowed;
            opacity: 0.6;
        }
        
        .feedback {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border: 2px solid #28a745;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            display: none;
        }
        
        .feedback.error {
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
            border-color: #dc3545;
        }
        
        .feedback.active {
            display: block;
            animation: slideIn 0.5s ease-out;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .timer {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 15px 25px;
            border-radius: 50px;
            font-size: 1.5em;
            font-weight: bold;
            z-index: 1000;
            display: none;
        }
        
        .timer.active {
            display: block;
        }
        
        .timer.warning {
            background: #ff6b35;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        
        .btn:active {
            transform: translateY(-1px);
        }
        
        .btn.secondary {
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
        }
        
        .material-info {
            background: rgba(255,255,255,0.9);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid #667eea;
        }
        
        .formula {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
            overflow-x: auto;
        }
        
        .hidden {
            display: none;
        }
        
        .notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #667eea;
            color: white;
            padding: 20px;
            border-radius: 10px;
            z-index: 9999;
            font-weight: bold;
            text-align: center;
            min-width: 300px;
        }
        
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 10px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .stats {
                gap: 20px;
            }
            
            .game-menu {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .options {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .timer {
                top: 10px;
                right: 10px;
                font-size: 1.2em;
                padding: 10px 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üß¨ Pokroƒçil√© materi√°lov√© in≈æen√Ωrstv√≠</h1>
            <p>Interaktivn√≠ hry pro studenty vysok√Ωch ≈°kol</p>
            <div class="stats">
                <div class="stat">
                    <div class="stat-value" id="totalScore">0</div>
                    <div class="stat-label">Celkov√© sk√≥re</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="correctAnswers">0</div>
                    <div class="stat-label">Spr√°vn√© odpovƒõdi</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="successRate">0%</div>
                    <div class="stat-label">√öspƒõ≈°nost</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="level">Zaƒç√°teƒçn√≠k</div>
                    <div class="stat-label">√örove≈à</div>
                </div>
            </div>
        </div>
        
        <div class="timer" id="timer">‚è±Ô∏è 45s</div>
        
        <div class="main-content">
            <div id="gameMenu">
                <div class="game-menu">
                    <div class="game-card classification" onclick="startGame('classification')">
                        <h3>üî¨ Pokroƒçil√© t≈ô√≠dƒõn√≠</h3>
                        <p>Slitiny, technick√° keramika, kompozity s mikrostrukturou. ƒåasov√Ω limit s bonusem za rychlost.</p>
                        <div class="points">10-20 bod≈Ø dle rychlosti</div>
                    </div>
                    
                    <div class="game-card properties" onclick="startGame('properties')">
                        <h3>‚öôÔ∏è Kvantitativn√≠ vlastnosti</h3>
                        <p>Lomov√° hou≈æevnatost, creep, √∫nava s matematick√Ωmi vzorci a v√Ωpoƒçty.</p>
                        <div class="points">10-15 bod≈Ø dle kvality</div>
                    </div>
                    
                    <div class="game-card selection" onclick="startGame('selection')">
                        <h3>üéØ Expertn√≠ volba</h3>
                        <p>Turb√≠ny, reaktory, lo≈æiska - re√°ln√© in≈æen√Ωrsk√© sc√©n√°≈ôe s komplexn√≠ anal√Ωzou.</p>
                        <div class="points">25-40 bod≈Ø dle slo≈æitosti</div>
                    </div>
                </div>
                
                <div class="material-info">
                    <h3>üìö Doporuƒçen√© prerekvizity:</h3>
                    <p>Fyzik√°ln√≠ chemie, Mechanika kontinua, Termodynamika, Strukturn√≠ anal√Ωza materi√°l≈Ø</p>
                </div>
            </div>
            
            <!-- Hra 1: Pokroƒçil√© t≈ô√≠dƒõn√≠ -->
            <div id="classificationGame" class="game-area">
                <div class="question-card">
                    <h2 id="materialName">Naƒç√≠t√°n√≠...</h2>
                    <div class="details" id="materialDetails"></div>
                </div>
                
                <h3 style="text-align: center; margin: 20px 0;">Do kter√© pokroƒçil√© kategorie tento materi√°l pat≈ô√≠?</h3>
                
                <div class="options" id="classificationOptions"></div>
                
                <div class="feedback" id="classificationFeedback"></div>
                
                <div style="text-align: center;">
                    <button class="btn" onclick="generateClassificationQuestion()">üîÑ Dal≈°√≠ ot√°zka</button>
                    <button class="btn secondary" onclick="showGameMenu()">‚Üê Hlavn√≠ menu</button>
                </div>
            </div>
            
            <!-- Hra 2: Vlastnosti -->
            <div id="propertiesGame" class="game-area">
                <div class="question-card">
                    <h2 id="propertyName">Naƒç√≠t√°n√≠...</h2>
                    <div class="details" id="propertyDetails"></div>
                </div>
                
                <div style="margin: 30px 0;">
                    <h3>üí° Napi≈°te vlastn√≠mi slovy co v√≠te o t√©to vlastnosti:</h3>
                    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; margin: 15px 0; border-left: 4px solid #ffd700;">
                        <strong>üéØ √ökol pro studenty:</strong><br>
                        Vysvƒõtlete v√Ωznam, aplikace a souvislosti t√©to materi√°lov√© vlastnosti. 
                        Uveƒète konkr√©tn√≠ p≈ô√≠klady pou≈æit√≠ v praxi.
                        <br><small>(Minimum 50 znak≈Ø pro zobrazen√≠ vysvƒõtlen√≠)</small>
                    </div>
                    <textarea id="userAnswer" placeholder="Napi≈°te zde svoje vysvƒõtlen√≠ t√©to materi√°lov√© vlastnosti..." 
                              style="width: 100%; height: 150px; padding: 15px; border-radius: 10px; border: 2px solid #e0e0e0; font-size: 16px; resize: vertical;"></textarea>
                </div>
                
                <div class="feedback" id="propertiesFeedback"></div>
                
                <div style="text-align: center;">
                    <button class="btn" id="revealBtn" onclick="revealPropertyAnswer()">üìñ Zobrazit odborn√© vysvƒõtlen√≠</button>
                    <button class="btn" onclick="generatePropertyQuestion()">üîÑ Dal≈°√≠ vlastnost</button>
                    <button class="btn secondary" onclick="showGameMenu()">‚Üê Hlavn√≠ menu</button>
                </div>
            </div>
            
            <!-- Hra 3: Volba materi√°lu -->
            <div id="selectionGame" class="game-area">
                <div class="question-card">
                    <h2 id="scenarioTitle">Naƒç√≠t√°n√≠...</h2>
                    <div class="details" id="scenarioDetails"></div>
                </div>
                
                <h3 style="text-align: center; margin: 20px 0;">Kter√Ω materi√°l byste zvolili?</h3>
                
                <div class="options" id="selectionOptions"></div>
                
                <div class="feedback" id="selectionFeedback"></div>
                
                <div style="text-align: center;">
                    <button class="btn" onclick="generateSelectionQuestion()">üîÑ Nov√Ω sc√©n√°≈ô</button>
                    <button class="btn secondary" onclick="showGameMenu()">‚Üê Hlavn√≠ menu</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Glob√°ln√≠ promƒõnn√©
        let gameStats = { correct: 0, total: 0 };
        let currentScore = 0;
        let timer = null;
        let timeLeft = 0;
        let currentGame = '';
        
        // Statistiky pro jednotliv√© hry
        let classificationStats = { correct: 0, total: 0 };
        let propertiesStats = { correct: 0, total: 0, answers: [] }; // P≈ôid√°no pole pro odpovƒõdi
        let selectionStats = { correct: 0, total: 0 };
        
        // Syst√©m pro sledov√°n√≠ pou≈æit√Ωch ot√°zek
        let usedClassificationQuestions = new Set();
        let usedPropertyQuestions = new Set();
        let usedSelectionQuestions = new Set();
        let allClassificationQuestions = [];
        let allPropertyQuestions = [];
        let allSelectionQuestions = [];
        
        // Data pro hry
        const advancedMaterialCategories = {
            'Slitiny ≈æeleza': {
                materials: ['Uhl√≠kov√° ocel (AISI 1045)', 'N√≠zkolegovan√° ocel (HSLA)', 'Nerezov√° ocel (316L)', 'Rychlo≈ôezn√° ocel (HSS)', '≈†ed√° litina (GG-25)', 'Tv√°rn√° litina (GGG-40)'],
                characteristics: 'Magnetick√©, dobr√© mechanick√© vlastnosti, n√°chylnost ke korozi'
            },
            'Ne≈æelezn√© kovy a slitiny': {
                materials: ['Hlin√≠kov√° slitina (7075-T6)', 'Titanov√° slitina (Ti-6Al-4V)', 'Mƒõdƒõn√° slitina (CuZn37)', 'Magn√©ziov√° slitina (AZ91)', 'Niklov√° superslitina (Inconel 718)', 'Bezberilyov√© bronzy'],
                characteristics: 'Vysok√Ω pomƒõr pevnosti k hmotnosti, odolnost korozi, vysok√° cena'
            },
            'Technick√° keramika': {
                materials: ['Oxid hlinit√Ω (Al‚ÇÇO‚ÇÉ)', 'Karbid k≈ôem√≠ku (SiC)', 'Nitrid k≈ôem√≠ku (Si‚ÇÉN‚ÇÑ)', 'Zirkoniƒçit√° keramika (ZrO‚ÇÇ)', 'Boridy', 'Karbid wolframu (WC-Co)'],
                characteristics: 'Vysok√° tvrdost, k≈ôehkost, chemick√° inertnost, vysokoteplotn√≠ stabilita'
            },
            'Technick√© polymery': {
                materials: ['PEEK (Poly√©ter√©terketon)', 'POM (Polyoxymethylen)', 'PA66-GF30 (Nylon s skeln√Ωmi vl√°kny)', 'PTFE (Teflon)', 'PPS (Polyfenylensulfid)', 'LCP (Tekutƒõ krystalick√© polymery)'],
                characteristics: 'N√≠zk√° hustota, viskoelastick√© chov√°n√≠, teplotn√≠ z√°vislost vlastnost√≠'
            },
            'Pokroƒçil√© kompozity': {
                materials: ['CFRP (Uhl√≠kov√° vl√°kna/epoxid)', 'GFRP (Skeln√° vl√°kna/polyester)', 'Aramidov√© kompozity', 'MMC (Al/SiC)', 'CMC (SiC/SiC)', 'Nanokomposiety'],
                characteristics: 'Anizotropn√≠ vlastnosti, vysok√Ω pomƒõr pevnosti/hmotnosti, slo≈æit√° v√Ωroba'
            },
            'Funkƒçn√≠ materi√°ly': {
                materials: ['Tvarov√° pamƒõ≈• (Nitinol)', 'Piezoelektrika (PZT)', 'Termoelektrika', 'Supervodiv√© keramiky', 'Magnetostrikƒçn√≠ materi√°ly', 'Feroelektrika'],
                characteristics: 'Speci√°ln√≠ fyzik√°ln√≠ vlastnosti, √∫zce specializovan√© aplikace'
            }
        };
        
        const advancedProperties = [
            { 
                name: 'Mez kluzu œÉy', 
                unit: 'MPa', 
                description: 'Napƒõt√≠ p≈ôi kter√©m zaƒç√≠n√° plastick√° deformace',
                examples: 'Ocel S235: 235 MPa, Ti-6Al-4V: 880 MPa',
                importance: 'Kritick√° pro dimenzov√°n√≠ p≈ôi statick√©m zat√≠≈æen√≠',
                formula: 'œÉy = F/A‚ÇÄ (p≈ôi 0.2% plastick√© deformaci)'
            },
            { 
                name: 'Lomov√° hou≈æevnatost KIC', 
                unit: 'MPa‚àöm', 
                description: 'Odolnost materi√°lu proti ≈°√≠≈ôen√≠ trhliny',
                examples: 'Keramika: 2-6, Hlin√≠k: 20-45, Ocel: 50-200',
                importance: 'Z√°sadn√≠ pro aplikace s rizikem k≈ôehk√©ho lomu',
                formula: 'KIC = œÉ‚àö(œÄa) pro nekoneƒçnou desku'
            },
            { 
                name: 'Souƒçinitel tepeln√© rozta≈ænosti Œ±', 
                unit: '10‚Åª‚Å∂/K', 
                description: 'Relativn√≠ zmƒõna rozmƒõru p≈ôi zmƒõnƒõ teploty',
                examples: 'Invar: 1.2, Ocel: 11-13, Hlin√≠k: 23-24',
                importance: 'Kl√≠ƒçov√© pro tepelnƒõ zat√≠≈æen√© konstrukce',
                formula: 'ŒîL/L‚ÇÄ = Œ±¬∑ŒîT'
            },
            { 
                name: '√önava - W√∂hlerova k≈ôivka', 
                unit: 'cykly', 
                description: 'Poƒçet cykl≈Ø do lomu p≈ôi dan√©m napƒõt√≠',
                examples: 'Ocel: mez √∫navy ~0.5œÉUTS, Hlin√≠k: bez meze √∫navy',
                importance: 'Z√°sadn√≠ pro cyklicky zat√≠≈æen√© souƒç√°sti',
                formula: 'log N = A - m¬∑log œÉa'
            },
            { 
                name: 'Creep - teƒçen√≠ za vysok√Ωch teplot', 
                unit: '%/h', 
                description: 'Postupn√° plastick√° deformace p≈ôi konstantn√≠m zat√≠≈æen√≠',
                examples: 'Superslitiny p≈ôi T > 0.5Tm, polymery p≈ôi T > Tg',
                importance: 'Limituje pou≈æit√≠ p≈ôi vysok√Ωch teplot√°ch',
                formula: 'ŒµÃá = A¬∑œÉ‚Åø¬∑exp(-Q/RT)'
            },
            { 
                name: 'Korozn√≠ rychlost', 
                unit: 'mm/rok', 
                description: 'Rychlost √∫bytku materi√°lu vlivem koroze',
                examples: 'Nerez v mo≈ôsk√© vodƒõ: 0.01, Ocel na vzduchu: 0.1',
                importance: 'Urƒçuje ≈æivotnost v agresivn√≠m prost≈ôed√≠',
                formula: 'CR = K¬∑W/(A¬∑T¬∑D)'
            }
        ];
        
        const engineeringScenarios = [
            {
                situation: "Lopatka plynov√© turb√≠ny (T = 1200¬∞C, œâ = 10000 ot/min)",
                requirements: [
                    "Creepov√° odolnost p≈ôi 1200¬∞C", 
                    "Odolnost tepeln√© √∫navƒõ", 
                    "N√≠zk√Ω koeficient tepeln√© rozta≈ænosti",
                    "Odolnost vysokoteplotn√≠ oxidaci",
                    "Dostateƒçn√° lomov√° hou≈æevnatost"
                ],
                correctMaterial: "Niklov√° superslitina (Inconel 718)",
                options: ["Niklov√° superslitina (Inconel 718)", "Uhl√≠kov√° ocel AISI 4140", "Hlin√≠kov√° slitina 7075-T6", "Titanov√° slitina Ti-6Al-4V"],
                explanation: "Superslitiny na b√°zi niklu jsou speci√°lnƒõ navr≈æeny pro vysokoteplotn√≠ aplikace. Inconel 718 si zachov√°v√° pevnost a≈æ do 650¬∞C a m√° vynikaj√≠c√≠ creepovou odolnost.",
                points: 35
            },
            {
                situation: "Tlakov√Ω reaktor pro chemick√Ω pr≈Ømysl (p = 50 bar, T = 300¬∞C, HCl prost≈ôed√≠)",
                requirements: [
                    "Odolnost v≈Øƒçi chloridov√© korozi",
                    "Vysok√° pevnost p≈ôi 300¬∞C",
                    "Odolnost napƒõ≈•ov√© koroze",
                    "Sva≈ôitelnost",
                    "Certifikace pro tlakov√© n√°doby"
                ],
                correctMaterial: "Nerezov√° ocel 316L",
                options: ["Nerezov√° ocel 316L", "Uhl√≠kov√° ocel P355GH", "Hlin√≠kov√° slitina 5083", "Titanov√° slitina Grade 2"],
                explanation: "316L obsahuje molybden (2-3%) kter√Ω v√Ωraznƒõ zvy≈°uje odolnost proti chloridov√© korozi. Ni≈æ≈°√≠ obsah uhl√≠ku (<0.03%) eliminuje citlivost na mezikrystalickou korozi.",
                points: 30
            },
            {
                situation: "Lo≈æiskov√© krou≈æky pro leteck√© motory (kontaktn√≠ napƒõt√≠ 3 GPa, T = 200¬∞C)",
                requirements: [
                    "Velmi vysok√° tvrdost (>60 HRC)",
                    "Lomov√° hou≈æevnatost >20 MPa‚àöm",
                    "Odolnost kontaktn√≠ √∫navƒõ",
                    "Rozmƒõrov√° stabilita",
                    "ƒåistota oceli (n√≠zk√Ω obsah inkluz√≠)"
                ],
                correctMaterial: "Lo≈æiskov√° ocel 100Cr6 (AISI 52100)",
                options: ["Lo≈æiskov√° ocel 100Cr6 (AISI 52100)", "Rychlo≈ôezn√° ocel M2", "Nerezov√° ocel 440C", "Cementaƒçn√≠ ocel 16MnCr5"],
                explanation: "100Cr6 je speci√°ln√≠ ocel s 1% C a 1.5% Cr, optimalizovan√° pro lo≈æiskov√© aplikace. Po kalen√≠ a popou≈°tƒõn√≠ dosahuje tvrdosti 60-65 HRC p≈ôi zachov√°n√≠ dostateƒçn√© hou≈æevnatosti.",
                points: 40
            },
            {
                situation: "Piezoelektrick√Ω aktu√°tor pro p≈ôesn√© pozicionov√°n√≠ (p≈ôesnost ¬±1 nm, f = 1 kHz)",
                requirements: [
                    "Vysok√Ω piezoelektrick√Ω koeficient d33",
                    "N√≠zk√© dielektrick√© ztr√°ty",
                    "Teplotn√≠ stabilita konstant",
                    "Mechanick√° stabilita",
                    "Rychl√° odezva"
                ],
                correctMaterial: "PZT keramika (PbZrTiO‚ÇÉ)",
                options: ["PZT keramika (PbZrTiO‚ÇÉ)", "K≈ôemen (SiO‚ÇÇ)", "Turmal√≠n", "PVDF polymer"],
                explanation: "PZT m√° nejvy≈°≈°√≠ piezoelektrick√© konstanty (d33 ‚âà 400 pC/N) d√≠ky morphotropick√© f√°zov√© hranici mezi tetragon√°ln√≠ a rhombohedrickou f√°z√≠.",
                points: 25
            }
        ];
        
        // Utility funkce
        function updateStats() {
            document.getElementById('totalScore').textContent = currentScore;
            document.getElementById('correctAnswers').textContent = gameStats.correct;
            const successRate = gameStats.total > 0 ? Math.round((gameStats.correct / gameStats.total) * 100) : 0;
            document.getElementById('successRate').textContent = successRate + '%';
            
            let level = 'Zaƒç√°teƒçn√≠k';
            if (currentScore > 200) level = 'Expert';
            else if (currentScore > 100) level = 'Pokroƒçil√Ω';
            else if (currentScore > 50) level = 'St≈ôednƒõ pokroƒçil√Ω';
            
            document.getElementById('level').textContent = level;
        }
        
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.innerHTML = message;
            document.body.appendChild(notification);
            setTimeout(() => notification.remove(), 2500);
        }
        
        function startTimer(seconds) {
            timeLeft = seconds;
            const timerEl = document.getElementById('timer');
            timerEl.classList.add('active');
            
            timer = setInterval(() => {
                timeLeft--;
                timerEl.textContent = `‚è±Ô∏è ${timeLeft}s`;
                
                if (timeLeft <= 10) {
                    timerEl.classList.add('warning');
                } else {
                    timerEl.classList.remove('warning');
                }
                
                if (timeLeft <= 0) {
                    stopTimer();
                    if (currentGame === 'classification') {
                        handleTimeout();
                    }
                }
            }, 1000);
        }
        
        function stopTimer() {
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
            document.getElementById('timer').classList.remove('active', 'warning');
        }
        
        function handleTimeout() {
            const options = document.querySelectorAll('#classificationOptions .option');
            options.forEach(opt => opt.classList.add('disabled'));
            
            const feedback = document.getElementById('classificationFeedback');
            feedback.innerHTML = '‚è∞ ƒåas vypr≈°el! Zkuste to znovu rychleji.';
            feedback.classList.add('active', 'error');
            
            // KRITICK√â: Aktualizuj statistiky i p≈ôi timeoutu
            classificationStats.total++;
            gameStats.total++;
            
            // Debug info
            console.log('TIMEOUT - ≈°patn√° odpovƒõƒè');
            console.log(`Statistiky t≈ô√≠dƒõn√≠: ${classificationStats.correct}/${classificationStats.total}`);
            
            updateStats();
        }
        
        // Inicializace v≈°ech mo≈æn√Ωch ot√°zek
        function initializeQuestions() {
            // Generuj v≈°echny mo≈æn√© klasifikaƒçn√≠ ot√°zky
            allClassificationQuestions = [];
            Object.keys(advancedMaterialCategories).forEach(category => {
                advancedMaterialCategories[category].materials.forEach(material => {
                    allClassificationQuestions.push({
                        material: material,
                        correctCategory: category,
                        characteristics: advancedMaterialCategories[category].characteristics,
                        id: `class_${material.replace(/[^a-zA-Z0-9]/g, '_')}`
                    });
                });
            });
            
            // Generuj v≈°echny vlastnosti
            allPropertyQuestions = [...advancedProperties];
            allPropertyQuestions.forEach((prop, index) => {
                prop.id = `prop_${index}`;
            });
            
            // Generuj v≈°echny sc√©n√°≈ôe
            allSelectionQuestions = [...engineeringScenarios];
            allSelectionQuestions.forEach((scenario, index) => {
                scenario.id = `scenario_${index}`;
            });
        }
        
        // Z√≠skej nevyu≈æitou ot√°zku
        function getUnusedQuestion(allQuestions, usedSet, gameType = '') {
            const availableQuestions = allQuestions.filter(q => !usedSet.has(q.id));
            
            // Pokud do≈°ly ot√°zky
            if (availableQuestions.length === 0) {
                if (gameType === 'classification') {
                    // Pro t≈ô√≠dƒõn√≠ zobraz souhrn a zastav hru
                    console.log('=== DOKONƒåENO V≈†ECH 24 OT√ÅZEK ===');
                    console.log(`Fin√°ln√≠ statistiky: ${classificationStats.correct}/${classificationStats.total}`);
                    showGameCompletionSummary();
                    return null;
                } else if (gameType === 'properties') {
                    // Pro vlastnosti zobraz souhrn v≈°ech odpovƒõd√≠
                    showPropertiesCompletionSummary();
                    return null;
                } else {
                    // Pro ostatn√≠ hry reset a pokraƒçuj
                    usedSet.clear();
                    showNotification('üîÑ V√Ωbornƒõ! Pro≈°li jste v≈°emi ot√°zkami.<br>Zaƒç√≠n√°me s nov√Ωmi kombinacemi!');
                    return getUnusedQuestion(allQuestions, usedSet, gameType);
                }
            }
            
            // N√°hodn√Ω v√Ωbƒõr z dostupn√Ωch
            const question = availableQuestions[Math.floor(Math.random() * availableQuestions.length)];
            usedSet.add(question.id);
            
            return question;
        }
        
        // Zobraz souhrn dokonƒçen√© hry
        function showGameCompletionSummary() {
            const totalClassification = allClassificationQuestions.length;
            const correctClassification = classificationStats.correct;
            const accuracy = totalClassification > 0 ? Math.round((correctClassification / totalClassification) * 100) : 0;
            
            // Debug informace
            console.log('=== STATISTIKY T≈ò√çDƒöN√ç ===');
            console.log('Spr√°vn√© odpovƒõdi:', correctClassification);
            console.log('Celkov√© ot√°zky:', totalClassification);
            console.log('√öspƒõ≈°nost:', accuracy + '%');
            console.log('Aktu√°ln√≠ sk√≥re:', currentScore);
            
            const summaryHTML = `
                <div class="question-card">
                    <h2>üéâ Gratulujeme! Dokonƒçili jste pokroƒçil√© t≈ô√≠dƒõn√≠!</h2>
                    <div class="details">
                        <h3>üìä V√°≈° v√Ωkon v t≈ô√≠dƒõn√≠:</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; margin: 20px 0;">
                            <div style="text-align: center; background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px;">
                                <div style="font-size: 2em; font-weight: bold; color: #ffd700;">${totalClassification}</div>
                                <div>Dokonƒçen√Ωch ot√°zek</div>
                            </div>
                            <div style="text-align: center; background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px;">
                                <div style="font-size: 2em; font-weight: bold; color: ${accuracy >= 80 ? '#4CAF50' : accuracy >= 60 ? '#FF9800' : '#F44336'};">${correctClassification}</div>
                                <div>Spr√°vn√Ωch odpovƒõd√≠</div>
                            </div>
                            <div style="text-align: center; background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px;">
                                <div style="font-size: 2em; font-weight: bold; color: ${accuracy >= 80 ? '#4CAF50' : accuracy >= 60 ? '#FF9800' : '#F44336'};">${accuracy}%</div>
                                <div>√öspƒõ≈°nost</div>
                            </div>
                            <div style="text-align: center; background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px;">
                                <div style="font-size: 2em; font-weight: bold; color: #ffd700;">${currentScore}</div>
                                <div>Z√≠skan√© body</div>
                            </div>
                        </div>
                        
                        <div style="background: ${accuracy >= 80 ? 'rgba(76, 175, 80, 0.2)' : accuracy >= 60 ? 'rgba(255, 152, 0, 0.2)' : 'rgba(244, 67, 54, 0.2)'}; padding: 20px; border-radius: 10px; margin: 20px 0; border-left: 5px solid ${accuracy >= 80 ? '#4CAF50' : accuracy >= 60 ? '#FF9800' : '#F44336'};">
                            <h4 style="margin-bottom: 10px;">üéØ Hodnocen√≠ v√Ωkonu:</h4>
                            ${accuracy >= 80 ? 
                                'üåü <strong>V√Ωborn√©!</strong> M√°te skvƒõl√© znalosti materi√°lov√Ωch kategori√≠. Jste p≈ôipraveni na pokroƒçil√© vlastnosti.' :
                                accuracy >= 60 ?
                                'üëç <strong>Dobr√©!</strong> Slu≈°n√Ω z√°klad, ale je≈°tƒõ si projdƒõte materi√°ly o mikrostruktu≈ôe a slo≈æen√≠.' :
                                'üìö <strong>Pot≈ôebujete procviƒçit.</strong> Doporuƒçujeme zopakovat z√°klady p≈ôed pokraƒçov√°n√≠m na dal≈°√≠ hry.'
                            }
                        </div>
                        
                        <h3 style="margin-top: 30px;">üéì Co jste procviƒçovali:</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; margin: 15px 0;">
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                                <strong>üî© Slitiny ≈æeleza:</strong><br>
                                <small>Uhl√≠kov√° ocel, nerez, litina, rychlo≈ôezn√© oceli</small>
                            </div>
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                                <strong>‚ö° Ne≈æelezn√© slitiny:</strong><br>
                                <small>Hlin√≠k, titan, mƒõƒè, superslitiny</small>
                            </div>
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                                <strong>üíé Technick√° keramika:</strong><br>
                                <small>Oxidy, karbidy, nitridy, boridy</small>
                            </div>
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                                <strong>üß™ Technick√© polymery:</strong><br>
                                <small>PEEK, POM, nylon, teflon</small>
                            </div>
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                                <strong>üèóÔ∏è Pokroƒçil√© kompozity:</strong><br>
                                <small>CFRP, MMC, nanokomposity</small>
                            </div>
                            <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px;">
                                <strong>‚ö° Funkƒçn√≠ materi√°ly:</strong><br>
                                <small>Tvarov√° pamƒõ≈•, piezoelektrika</small>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn" onclick="resetClassificationGame()">üîÑ Hr√°t znovu</button>
                    <button class="btn secondary" onclick="showGameMenu()">‚Üê Hlavn√≠ menu</button>
                </div>
            `;
            
            document.getElementById('classificationOptions').innerHTML = '';
            document.getElementById('classificationFeedback').innerHTML = summaryHTML;
            document.getElementById('classificationFeedback').classList.add('active');
            
            // Skryj tlaƒç√≠tko pro dal≈°√≠ ot√°zku
            const gameButtons = document.querySelectorAll('#classificationGame .btn');
            gameButtons.forEach(btn => {
                if (btn.textContent.includes('Dal≈°√≠ ot√°zka')) {
                    btn.style.display = 'none';
                }
            });
        }
        
        // Zobraz souhrn dokonƒçen√Ωch kvantitativn√≠ch vlastnost√≠
        function showPropertiesCompletionSummary() {
            const totalProperties = allPropertyQuestions.length;
            const goodAnswers = propertiesStats.correct;
            const accuracy = totalProperties > 0 ? Math.round((goodAnswers / totalProperties) * 100) : 0;
            const totalPoints = propertiesStats.answers.reduce((sum, answer) => sum + answer.points, 0);
            
            console.log('=== DOKONƒåENY KVANTITATIVN√ç VLASTNOSTI ===');
            console.log(`Statistiky: ${goodAnswers}/${totalProperties} (${accuracy}%)`);
            console.log('V≈°echny odpovƒõdi:', propertiesStats.answers);
            
            // Vytvo≈ô p≈ôehled v≈°ech odpovƒõd√≠
            const answersReview = propertiesStats.answers.map((answer, index) => `
                <div style="background: ${answer.isGood ? 'rgba(76, 175, 80, 0.1)' : 'rgba(244, 67, 54, 0.1)'}; 
                            border-left: 5px solid ${answer.isGood ? '#4CAF50' : '#F44336'}; 
                            padding: 15px; border-radius: 8px; margin: 10px 0;">
                    <h5 style="margin: 0 0 10px 0; color: #333;">
                        ${index + 1}. ${answer.property}
                        <span style="float: right; color: ${answer.isGood ? '#4CAF50' : '#F44336'}; font-weight: bold;">
                            ${answer.rating} (${answer.points}b)
                        </span>
                    </h5>
                    <div style="background: rgba(255,255,255,0.3); padding: 10px; border-radius: 5px; font-size: 0.9em;">
                        <strong>Va≈°e odpovƒõƒè:</strong> ${answer.userAnswer.substring(0, 100)}${answer.userAnswer.length > 100 ? '...' : ''}
                    </div>
                </div>
            `).join('');
            
            const summaryHTML = `
                <div class="question-card">
                    <h2>üéâ Dokonƒçili jste kvantitativn√≠ vlastnosti!</h2>
                    <div class="details">
                        <h3>üìä Celkov√Ω p≈ôehled va≈°ich odpovƒõd√≠:</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; margin: 20px 0;">
                            <div style="text-align: center; background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px;">
                                <div style="font-size: 2em; font-weight: bold; color: #ffd700;">${totalProperties}</div>
                                <div>Dokonƒçen√Ωch vlastnost√≠</div>
                            </div>
                            <div style="text-align: center; background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px;">
                                <div style="font-size: 2em; font-weight: bold; color: ${accuracy >= 70 ? '#4CAF50' : accuracy >= 50 ? '#FF9800' : '#F44336'};">${goodAnswers}</div>
                                <div>Kvalitn√≠ch odpovƒõd√≠</div>
                            </div>
                            <div style="text-align: center; background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px;">
                                <div style="font-size: 2em; font-weight: bold; color: ${accuracy >= 70 ? '#4CAF50' : accuracy >= 50 ? '#FF9800' : '#F44336'};">${accuracy}%</div>
                                <div>√öspƒõ≈°nost</div>
                            </div>
                            <div style="text-align: center; background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px;">
                                <div style="font-size: 2em; font-weight: bold; color: #ffd700;">${totalPoints}</div>
                                <div>Z√≠skan√© body</div>
                            </div>
                        </div>
                        
                        <div style="background: ${accuracy >= 70 ? 'rgba(76, 175, 80, 0.2)' : accuracy >= 50 ? 'rgba(255, 152, 0, 0.2)' : 'rgba(244, 67, 54, 0.2)'}; padding: 20px; border-radius: 10px; margin: 20px 0; border-left: 5px solid ${accuracy >= 70 ? '#4CAF50' : accuracy >= 50 ? '#FF9800' : '#F44336'};">
                            <h4 style="margin-bottom: 10px;">üéØ Hodnocen√≠ kvality odpovƒõd√≠:</h4>
                            ${accuracy >= 70 ? 
                                'üåü <strong>V√Ωborn√©!</strong> M√°te skvƒõl√© porozumƒõn√≠ kvantitativn√≠m vlastnostem. Jste p≈ôipraveni na expertn√≠ volbu materi√°l≈Ø.' :
                                accuracy >= 50 ?
                                'üëç <strong>Dobr√©!</strong> Slu≈°n√° znalost vlastnost√≠, ale zkuste b√Ωt detailnƒõj≈°√≠ v odpovƒõd√≠ch.' :
                                'üìö <strong>Pot≈ôebujete procviƒçit.</strong> Zkuste ps√°t podrobnƒõj≈°√≠ odpovƒõdi s konkr√©tn√≠mi aplikacemi a souvislostmi.'
                            }
                        </div>
                        
                        <h3 style="margin-top: 30px;">üìù P≈ôehled v≈°ech va≈°ich odpovƒõd√≠:</h3>
                        <div style="max-height: 400px; overflow-y: auto; margin: 15px 0;">
                            ${answersReview}
                        </div>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn" onclick="resetPropertiesGame()">üîÑ Hr√°t znovu</button>
                    <button class="btn secondary" onclick="showGameMenu()">‚Üê Hlavn√≠ menu</button>
                </div>
            `;
            
            document.getElementById('propertyName').innerHTML = '';
            document.getElementById('propertyDetails').innerHTML = summaryHTML;
            
            // Skryj ostatn√≠ prvky
            document.querySelector('#propertiesGame textarea').style.display = 'none';
            document.getElementById('propertiesFeedback').classList.remove('active');
            
            const gameButtons = document.querySelectorAll('#propertiesGame .btn');
            gameButtons.forEach(btn => {
                if (btn.textContent.includes('Dal≈°√≠ vlastnost') || btn.textContent.includes('Zobrazit')) {
                    btn.style.display = 'none';
                }
            });
        }
        
        // Reset hry vlastnost√≠
        function resetPropertiesGame() {
            usedPropertyQuestions.clear();
            propertiesStats = { correct: 0, total: 0, answers: [] };
            
            document.querySelector('#propertiesGame textarea').style.display = 'block';
            document.getElementById('propertiesFeedback').classList.remove('active');
            
            const gameButtons = document.querySelectorAll('#propertiesGame .btn');
            gameButtons.forEach(btn => {
                if (btn.textContent.includes('Dal≈°√≠ vlastnost') || btn.textContent.includes('Zobrazit')) {
                    btn.style.display = 'inline-block';
                }
            });
            
            generatePropertyQuestion();
        }

        // Navigace mezi hrami
        function startGame(gameType) {
            currentGame = gameType;
            document.getElementById('gameMenu').style.display = 'none';
            
            // Reset statistik p≈ôi zaƒç√°tku nov√© hry
            if (gameType === 'classification') {
                classificationStats = { correct: 0, total: 0 };
                console.log('üéÆ ZAƒå√ÅTEK NOV√â HRY - statistiky resetov√°ny na 0/0');
            } else if (gameType === 'properties') {
                propertiesStats = { correct: 0, total: 0, answers: [] };
                console.log('üéÆ ZAƒå√ÅTEK KVANTITATIVN√çCH VLASTNOST√ç - statistiky resetov√°ny');
            }
            
            document.querySelectorAll('.game-area').forEach(area => {
                area.classList.remove('active');
            });
            
            const gameArea = document.getElementById(gameType + 'Game');
            gameArea.classList.add('active');
            
            if (gameType === 'classification') {
                generateClassificationQuestion();
            } else if (gameType === 'properties') {
                generatePropertyQuestion();
            } else if (gameType === 'selection') {
                generateSelectionQuestion();
            }
        }
        
        function showGameMenu() {
            currentGame = '';
            stopTimer();
            document.getElementById('gameMenu').style.display = 'block';
            
            document.querySelectorAll('.game-area').forEach(area => {
                area.classList.remove('active');
            });
        }
        
        // Hra 1: Pokroƒçil√© t≈ô√≠dƒõn√≠ (opraven√° verze)
        function generateClassificationQuestion() {
            const question = getUnusedQuestion(allClassificationQuestions, usedClassificationQuestions, 'classification');
            
            // Pokud do≈°ly ot√°zky, nezobrazuj novou ot√°zku
            if (!question) {
                return;
            }
            
            document.getElementById('materialName').textContent = question.material;
            document.getElementById('materialDetails').innerHTML = `
                <div style="text-align: center; background: rgba(255,255,255,0.2); padding: 20px; border-radius: 10px;">
                    <strong>üéØ √ökol:</strong><br>
                    Identifikujte spr√°vnou kategorii tohoto materi√°lu na z√°kladƒõ sv√Ωch znalost√≠ o jeho vlastnostech a slo≈æen√≠.
                </div>
                <div style="margin-top: 15px; text-align: center;">
                    <small>üìä Zb√Ωvaj√≠c√≠ ot√°zky: ${allClassificationQuestions.length - usedClassificationQuestions.size}/${allClassificationQuestions.length}</small>
                </div>
            `;
            
            // Vygeneruj mo≈ænosti
            const categories = Object.keys(advancedMaterialCategories);
            const wrongCategories = categories.filter(cat => cat !== question.correctCategory).sort(() => Math.random() - 0.5).slice(0, 2);
            const options = [question.correctCategory, ...wrongCategories].sort(() => Math.random() - 0.5);
            
            const optionsContainer = document.getElementById('classificationOptions');
            optionsContainer.innerHTML = '';
            
            options.forEach(option => {
                const optionEl = document.createElement('div');
                optionEl.className = 'option';
                optionEl.innerHTML = `<strong>${option}</strong>`;
                optionEl.onclick = () => checkClassificationAnswer(option, question.correctCategory);
                optionsContainer.appendChild(optionEl);
            });
            
            // Reset feedback
            const feedback = document.getElementById('classificationFeedback');
            feedback.classList.remove('active', 'error');
            
            // Spust√≠ timer
            startTimer(45);
        }
        
        function checkClassificationAnswer(selected, correct) {
            stopTimer();
            const isCorrect = selected === correct;
            const options = document.querySelectorAll('#classificationOptions .option');
            
            options.forEach(opt => {
                opt.classList.add('disabled');
                if (opt.innerHTML.includes(selected)) {
                    opt.classList.add(isCorrect ? 'correct' : 'incorrect');
                }
                if (opt.innerHTML.includes(correct) && !isCorrect) {
                    opt.classList.add('correct');
                }
            });
            
            const points = isCorrect ? (timeLeft > 30 ? 20 : timeLeft > 15 ? 15 : 10) : 0;
            if (points > 0) currentScore += points;
            
            // KRITICK√â: Aktualizuj statistiky PRVN√ç
            classificationStats.total++;
            gameStats.total++;
            if (isCorrect) {
                classificationStats.correct++;
                gameStats.correct++;
            }
            
            // Debug info
            console.log(`Odpovƒõƒè: ${isCorrect ? 'SPR√ÅVNƒö' : '≈†PATNƒö'}`);
            console.log(`Statistiky t≈ô√≠dƒõn√≠: ${classificationStats.correct}/${classificationStats.total}`);
            
            const feedback = document.getElementById('classificationFeedback');
            feedback.innerHTML = isCorrect ? 
                `‚úÖ Spr√°vnƒõ! Z√≠sk√°v√°te ${points} bod≈Ø.<br><strong>Vysvƒõtlen√≠:</strong> ${advancedMaterialCategories[correct].characteristics}` :
                `‚ùå Nespr√°vnƒõ. Spr√°vn√° odpovƒõƒè: ${correct}.<br><strong>Vysvƒõtlen√≠:</strong> ${advancedMaterialCategories[correct].characteristics}`;
            feedback.classList.add('active', isCorrect ? '' : 'error');
            
            updateStats();
        }
        
        // Hra 2: Vlastnosti (opraven√° verze - bez popis≈Ø)
        function generatePropertyQuestion() {
            const property = getUnusedQuestion(allPropertyQuestions, usedPropertyQuestions, 'properties');
            
            // Pokud do≈°ly ot√°zky, pokraƒçuj s resetem
            if (!property) {
                return;
            }
            
            document.getElementById('propertyName').textContent = property.name;
            document.getElementById('propertyDetails').innerHTML = `
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                    <div style="text-align: center; background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px;">
                        <strong>Jednotka:</strong><br>
                        <span style="font-size: 1.3em; color: #ffd700;">${property.unit}</span>
                    </div>
                    <div style="text-align: center; background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px;">
                        <strong>P≈ô√≠klady hodnot:</strong><br>
                        <span style="font-size: 0.9em;">${property.examples}</span>
                    </div>
                    ${property.formula ? `
                    <div style="text-align: center; background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px;">
                        <strong>Vzorec:</strong><br>
                        <div class="formula" style="font-size: 0.9em; margin-top: 5px;">${property.formula}</div>
                    </div>
                    ` : ''}
                </div>
                <div style="margin-top: 15px; text-align: center;">
                    <small>üìä Zb√Ωvaj√≠c√≠ vlastnosti: ${allPropertyQuestions.length - usedPropertyQuestions.size}/${allPropertyQuestions.length}</small>
                </div>
            `;
            
            // Reset
            document.getElementById('userAnswer').value = '';
            document.getElementById('revealBtn').style.display = 'inline-block';
            document.getElementById('revealBtn').textContent = 'üìñ Zobrazit odborn√© vysvƒõtlen√≠';
            
            const feedback = document.getElementById('propertiesFeedback');
            feedback.classList.remove('active');
            
            // Ulo≈æ√≠me aktu√°ln√≠ vlastnost pro pozdƒõj≈°√≠ pou≈æit√≠
            window.currentProperty = property;
        }
        
        function revealPropertyAnswer() {
            const userAnswer = document.getElementById('userAnswer').value.trim();
            
            // Kontrola kvality odpovƒõdi - obsah I d√©lka
            let points = 0;
            let isGoodAnswer = false;
            let feedbackMessage = '';
            let rating = '';
            
            // Kl√≠ƒçov√° slova pro ka≈ædou vlastnost
            const currentProperty = window.currentProperty;
            let keyWords = [];
            let qualityScore = 0;
            
            // Definuj kl√≠ƒçov√° slova podle vlastnosti
            switch(currentProperty.name) {
                case 'Mez kluzu œÉy':
                    keyWords = ['plastick', 'deformac', 'napƒõt√≠', 'zat√≠≈æ', 'pevnost', 'dimenz', 'konstrukc', 'bezpeƒç'];
                    break;
                case 'Lomov√° hou≈æevnatost KIC':
                    keyWords = ['trhlin', 'lom', 'k≈ôehk', '≈°√≠≈ôen√≠', 'bezpeƒç', 'kritick', 'napƒõt√≠', 'defekt'];
                    break;
                case 'Souƒçinitel tepeln√© rozta≈ænosti Œ±':
                    keyWords = ['teplot', 'rozmƒõr', 'rozta≈æ', 'zmƒõna', 'tepeln', 'kompenz', 'konstrukc', 'spoj'];
                    break;
                case '√önava - W√∂hlerova k≈ôivka':
                    keyWords = ['cykl', 'opakovan', 'zat√≠≈æ', '√∫navov', 'poƒçet', '≈æivotnost', 'st≈ô√≠dav', 'dynamick'];
                    break;
                case 'Creep - teƒçen√≠ za vysok√Ωch teplot':
                    keyWords = ['teplot', 'ƒças', 'teƒçen', 'deformac', 'creep', 'vysokoteplot', 'postupn', 'dlouhodob'];
                    break;
                case 'Korozn√≠ rychlost':
                    keyWords = ['koroz', 'prost≈ôed', 'chemick', 'degradac', '≈æivotnost', 'ochran', '√∫byt', 'povrch'];
                    break;
                default:
                    keyWords = ['materi√°l', 'vlastnost', 'pou≈æit', 'aplikac'];
            }
            
            // Spoƒç√≠tej kvalitu obsahu
            const lowerAnswer = userAnswer.toLowerCase();
            keyWords.forEach(word => {
                if (lowerAnswer.includes(word)) {
                    qualityScore++;
                }
            });
            
            // Kontrola obecn√Ωch fr√°z√≠ (negativn√≠ body)
            const badPhrases = ['je d≈Øle≈æit√©', 'je to d≈Øle≈æit√©', 'je v√Ωznamn√©', 'je podstatn√©', 'je nutn√©', 'je t≈ôeba'];
            let hasBadPhrases = badPhrases.some(phrase => lowerAnswer.includes(phrase));
            
            // Hodnocen√≠ kvality
            if (userAnswer.length < 20) {
                feedbackMessage = '‚ùå <strong>Nedostateƒçn√° odpovƒõƒè!</strong><br>Va≈°e odpovƒõƒè je p≈ô√≠li≈° kr√°tk√°. Napi≈°te alespo≈à 20 znak≈Ø s konkr√©tn√≠m vysvƒõtlen√≠m.';
                points = 0;
                rating = 'Nedostateƒçn√°';
            } else if (qualityScore === 0 || hasBadPhrases) {
                feedbackMessage = '‚ùå <strong>Nespr√°vn√° odpovƒõƒè!</strong><br>Va≈°e odpovƒõƒè neobsahuje relevantn√≠ technick√© informace. Pou≈æijte konkr√©tn√≠ term√≠ny a vysvƒõtlen√≠.';
                points = 0;
                rating = 'Nespr√°vn√°';
            } else if (qualityScore <= 2 && userAnswer.length < 50) {
                feedbackMessage = '‚ö†Ô∏è <strong>Slab√° odpovƒõƒè!</strong><br>M√°te z√°kladn√≠ p≈ôedstavu, ale odpovƒõƒè je velmi struƒçn√° a chyb√≠ technick√© detaily.';
                points = 3;
                isGoodAnswer = true;
                rating = 'Slab√°';
            } else if (qualityScore <= 3 && userAnswer.length < 100) {
                feedbackMessage = 'üëç <strong>Dobr√° odpovƒõƒè!</strong><br>Obsahuje relevantn√≠ informace, ale mohla by b√Ωt podrobnƒõj≈°√≠ s v√≠ce technick√Ωmi detaily.';
                points = 8;
                isGoodAnswer = true;
                rating = 'Dobr√°';
            } else if (qualityScore >= 4 && userAnswer.length >= 80) {
                feedbackMessage = 'üåü <strong>V√Ωborn√° odpovƒõƒè!</strong><br>Detailn√≠ technick√© vysvƒõtlen√≠ s konkr√©tn√≠mi term√≠ny a aplikacemi.';
                points = 15;
                isGoodAnswer = true;
                rating = 'V√Ωborn√°';
            } else {
                feedbackMessage = 'üëç <strong>Dobr√° odpovƒõƒè!</strong><br>Slu≈°n√© vysvƒõtlen√≠, ale mohlo by obsahovat v√≠ce technick√Ωch detail≈Ø.';
                points = 6;
                isGoodAnswer = true;
                rating = 'Dobr√°';
            }
            
            // Debug informace
            console.log(`=== HODNOCEN√ç ODPOVƒöDI ===`);
            console.log(`Vlastnost: ${currentProperty.name}`);
            console.log(`D√©lka odpovƒõdi: ${userAnswer.length} znak≈Ø`);
            console.log(`Kl√≠ƒçov√° slova nalezena: ${qualityScore}/${keyWords.length}`);
            console.log(`≈†patn√© fr√°ze: ${hasBadPhrases}`);
            console.log(`Hodnocen√≠: ${rating} (${points} bod≈Ø)`);
            
            // Ulo≈æit odpovƒõƒè do statistik
            propertiesStats.answers.push({
                property: window.currentProperty.name,
                userAnswer: userAnswer,
                points: points,
                rating: rating,
                isGood: isGoodAnswer,
                qualityScore: qualityScore,
                keyWordsFound: keyWords.filter(word => lowerAnswer.includes(word))
            });
            
            // Aktualizuj statistiky
            propertiesStats.total++;
            if (isGoodAnswer) {
                propertiesStats.correct++;
                currentScore += points;
            }
            
            const feedback = document.getElementById('propertiesFeedback');
            feedback.innerHTML = `
                <div style="background: ${isGoodAnswer ? 'rgba(76, 175, 80, 0.1)' : 'rgba(244, 67, 54, 0.1)'}; padding: 20px; border-radius: 10px; border-left: 5px solid ${isGoodAnswer ? '#4CAF50' : '#F44336'}; margin-bottom: 20px;">
                    ${feedbackMessage}
                    <br><strong>Z√≠skan√© body: ${points > 0 ? '+' : ''}${points}</strong>
                    ${qualityScore > 0 ? `<br><small>Nalezen√© kl√≠ƒçov√© pojmy: ${keyWords.filter(word => lowerAnswer.includes(word)).join(', ')}</small>` : ''}
                </div>
                
                <h4>üìö Odborn√© vysvƒõtlen√≠:</h4>
                <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; margin-top: 15px;">
                    <p><strong>V√Ωznam:</strong> ${window.currentProperty.importance}</p>
                    <p><strong>Detailn√≠ popis:</strong> ${window.currentProperty.description}</p>
                    ${window.currentProperty.formula ? `
                        <div style="margin: 15px 0;">
                            <strong>Matematick√Ω vztah:</strong>
                            <div class="formula">${window.currentProperty.formula}</div>
                        </div>
                    ` : ''}
                    <p><strong>Typick√© hodnoty:</strong> ${window.currentProperty.examples}</p>
                    
                    <div style="background: rgba(0,0,0,0.1); padding: 15px; border-radius: 8px; margin-top: 15px;">
                        <strong>üí° Praktick√© aplikace:</strong><br>
                        Tato vlastnost je kl√≠ƒçov√° p≈ôi navrhov√°n√≠ komponent≈Ø pro specializovan√© in≈æen√Ωrsk√© aplikace.
                        ${!isGoodAnswer ? `<br><br><strong>üí≠ Tip pro zlep≈°en√≠:</strong> V odpovƒõdi pou≈æijte konkr√©tn√≠ technick√© term√≠ny jako: ${keyWords.slice(0, 4).join(', ')}. Vysvƒõtlete souvislosti a praktick√© aplikace.` : ''}
                    </div>
                </div>
            `;
            feedback.classList.add('active');
            
            document.getElementById('revealBtn').style.display = 'none';
            updateStats();
        }
        
        // Hra 3: Volba materi√°lu (opraven√° verze)
        function generateSelectionQuestion() {
            const scenario = getUnusedQuestion(allSelectionQuestions, usedSelectionQuestions, 'selection');
            
            // Pokud do≈°ly ot√°zky, pokraƒçuj s resetem
            if (!scenario) {
                return;
            }
            
            document.getElementById('scenarioTitle').textContent = scenario.situation;
            document.getElementById('scenarioDetails').innerHTML = `
                <h4>üéØ Technick√© po≈æadavky:</h4>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    ${scenario.requirements.map(req => `<li>${req}</li>`).join('')}
                </ul>
                <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 8px; margin-top: 15px;">
                    <strong>‚ö†Ô∏è Kritick√© aspekty:</strong><br>
                    Zva≈æte interakci mezi jednotliv√Ωmi po≈æadavky a mo≈æn√© kompromisy.<br>
                    <small>üìä Zb√Ωvaj√≠c√≠ sc√©n√°≈ôe: ${allSelectionQuestions.length - usedSelectionQuestions.size}/${allSelectionQuestions.length}</small>
                </div>
            `;
            
            const optionsContainer = document.getElementById('selectionOptions');
            optionsContainer.innerHTML = '';
            
            scenario.options.forEach(option => {
                const optionEl = document.createElement('div');
                optionEl.className = 'option';
                optionEl.innerHTML = `<strong>${option}</strong>`;
                optionEl.onclick = () => checkSelectionAnswer(option, scenario);
                optionsContainer.appendChild(optionEl);
            });
            
            const feedback = document.getElementById('selectionFeedback');
            feedback.classList.remove('active', 'error');
            
            // Ulo≈æ√≠me aktu√°ln√≠ sc√©n√°≈ô
            window.currentScenario = scenario;
        }
        
        function checkSelectionAnswer(selected, scenario) {
            const isCorrect = selected === scenario.correctMaterial;
            const options = document.querySelectorAll('#selectionOptions .option');
            
            options.forEach(opt => {
                opt.classList.add('disabled');
                if (opt.innerHTML.includes(selected)) {
                    opt.classList.add(isCorrect ? 'correct' : 'incorrect');
                }
                if (opt.innerHTML.includes(scenario.correctMaterial) && !isCorrect) {
                    opt.classList.add('correct');
                }
            });
            
            if (isCorrect) currentScore += scenario.points;
            
            const feedback = document.getElementById('selectionFeedback');
            feedback.innerHTML = `
                <h4>${isCorrect ? '‚úÖ V√Ωbornƒõ!' : '‚ùå Nespr√°vnƒõ'}</h4>
                <p>${isCorrect ? `Z√≠sk√°v√°te ${scenario.points} bod≈Ø! ` : `Spr√°vnou volbou by byl ${scenario.correctMaterial}. `}${scenario.explanation}</p>
                <div style="background: rgba(0,0,0,0.1); padding: 15px; border-radius: 8px; margin-top: 15px;">
                    <strong>üî¨ Technick√© zd≈Øvodnƒõn√≠:</strong><br>
                    Anal√Ωza po≈æadavk≈Ø ukazuje, ≈æe materi√°l mus√≠ spl≈àovat kombinaci mechanick√Ωch, tepeln√Ωch a chemick√Ωch vlastnost√≠. 
                    Spr√°vn√° volba vy≈æaduje pochopen√≠ mikrostruktury a jej√≠ souvislosti s makroskopick√Ωmi vlastnostmi.
                </div>
            `;
            feedback.classList.add('active', isCorrect ? '' : 'error');
            
            gameStats.total++;
            if (isCorrect) gameStats.correct++;
            updateStats();
        }
        
        // Inicializace p≈ôi naƒçten√≠ str√°nky
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üöÄ Inicializace aplikace...');
            try {
                initializeQuestions();
                updateStats();
                console.log('‚úÖ Aplikace p≈ôipravena!');
                showNotification('üéØ Aplikace naƒçtena! Vyberte hru z menu.');
            } catch (error) {
                console.error('‚ùå Chyba p≈ôi inicializaci:', error);
                showNotification('‚ö†Ô∏è Chyba p≈ôi naƒç√≠t√°n√≠. Obnovte str√°nku.');
            }
        });
    </script>
</body>
</html>