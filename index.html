<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Progresívne technológie - LMS systém</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .header h1 {
            color: #2196F3;
            font-size: 2rem;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .role-badge {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
        }
        
        .role-teacher {
            background: #4CAF50;
            color: white;
        }
        
        .role-student {
            background: #2196F3;
            color: white;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }
        
        .btn-primary {
            background: #2196F3;
            color: white;
        }
        
        .btn-success {
            background: #4CAF50;
            color: white;
        }
        
        .btn-danger {
            background: #f44336;
            color: white;
        }
        
        .btn-secondary {
            background: #757575;
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .auth-section {
            background: white;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            max-width: 500px;
            margin: 50px auto;
        }
        
        .auth-tabs {
            display: flex;
            margin-bottom: 30px;
            background: #f5f5f5;
            border-radius: 10px;
            padding: 5px;
        }
        
        .auth-tab {
            flex: 1;
            padding: 15px;
            background: transparent;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .auth-tab.active {
            background: #2196F3;
            color: white;
        }
        
        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }
        
        .form-control {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }
        
        .form-control:focus {
            outline: none;
            border-color: #2196F3;
        }
        
        .dashboard {
            display: none;
        }
        
        .dashboard.active {
            display: block;
        }
        
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .card h3 {
            color: #2196F3;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: #333;
            margin: 10px 0;
        }
        
        .games-list {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .games-list h3 {
            color: #2196F3;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        
        .game-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border: 2px solid #f0f0f0;
            border-radius: 10px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
        }
        
        .game-item:hover {
            border-color: #2196F3;
            background: #f8f9fa;
        }
        
        .game-info h4 {
            color: #333;
            margin-bottom: 5px;
        }
        
        .game-info p {
            color: #666;
            font-size: 0.9rem;
        }
        
        .game-stats {
            text-align: right;
            font-size: 0.9rem;
            color: #666;
        }
        
        .results-table {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow-x: auto;
        }
        
        .results-table h3 {
            color: #2196F3;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }
        
        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #333;
        }
        
        tr:hover {
            background: #f8f9fa;
        }
        
        .score-badge {
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .score-excellent {
            background: #4CAF50;
            color: white;
        }
        
        .score-good {
            background: #FF9800;
            color: white;
        }
        
        .score-poor {
            background: #f44336;
            color: white;
        }
        
        .hidden {
            display: none;
        }
        
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .alert-success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        
        .alert-danger {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        
        .filters {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .filter-group label {
            font-weight: 600;
            color: #555;
            font-size: 0.9rem;
        }
        
        .filter-group select, .filter-group input {
            padding: 8px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 0.9rem;
        }
        
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 15px;
            }
            
            .user-info {
                justify-content: center;
            }
            
            .cards-grid {
                grid-template-columns: 1fr;
            }
            
            .filters {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Authentication Section -->
        <div id="auth-section" class="auth-section">
            <h2>Prihlásenie do systému</h2>
            <div class="auth-tabs">
                <button class="auth-tab active" onclick="switchAuthTab('login')">Prihlásenie</button>
                <button class="auth-tab" onclick="switchAuthTab('register')">Registrácia</button>
            </div>
            
            <div id="login-form">
                <form onsubmit="login(event)">
                    <div class="form-group">
                        <label for="login-email">Email:</label>
                        <input type="email" id="login-email" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="login-password">Heslo:</label>
                        <input type="password" id="login-password" class="form-control" required>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%;">Prihlásiť sa</button>
                </form>
                
                <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; font-size: 0.9rem;">
                    <strong>Demo účty:</strong><br>
                    Učiteľ: teacher@vste.sk / heslo123<br>
                    Študent: student@vste.sk / heslo123
                </div>
            </div>
            
            <div id="register-form" class="hidden">
                <form onsubmit="register(event)">
                    <div class="form-group">
                        <label for="reg-name">Meno a priezvisko:</label>
                        <input type="text" id="reg-name" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="reg-email">Email:</label>
                        <input type="email" id="reg-email" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="reg-password">Heslo:</label>
                        <input type="password" id="reg-password" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="reg-role">Rola:</label>
                        <select id="reg-role" class="form-control">
                            <option value="student">Študent</option>
                            <option value="teacher">Učiteľ</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-success" style="width: 100%;">Registrovať sa</button>
                </form>
            </div>
        </div>

        <!-- Main Dashboard -->
        <div id="main-dashboard" class="dashboard">
            <div class="header">
                <h1>Progresívne technológie - LMS</h1>
                <div class="user-info">
                    <span id="user-name">Užívateľ</span>
                    <span id="user-role" class="role-badge">Rola</span>
                    <button class="btn btn-secondary" onclick="logout()">Odhlásiť sa</button>
                </div>
            </div>

            <!-- Student Dashboard -->
            <div id="student-dashboard" class="dashboard">
                <div class="cards-grid">
                    <div class="card">
                        <h3>Moje štatistiky</h3>
                        <div class="stat-number" id="student-games-played">0</div>
                        <p>Odohratých hier</p>
                    </div>
                    <div class="card">
                        <h3>Priemerné skóre</h3>
                        <div class="stat-number" id="student-avg-score">0%</div>
                        <p>Zo všetkých hier</p>
                    </div>
                    <div class="card">
                        <h3>Najlepší výsledok</h3>
                        <div class="stat-number" id="student-best-score">0%</div>
                        <p>Najvyššie dosiahnuté skóre</p>
                    </div>
                </div>

                <div class="games-list">
                    <h3>Dostupné hry</h3>
                    <div class="game-item">
                        <div class="game-info">
                            <h4>Kvíz - Základné pojmy</h4>
                            <p>6 otázok o konvenčných a progresívnych technológiách</p>
                        </div>
                        <div>
                            <button class="btn btn-primary" onclick="startStudentGame('quiz')">Hrať</button>
                        </div>
                    </div>
                    <div class="game-item">
                        <div class="game-info">
                            <h4>Pexeso - Technológie</h4>
                            <p>Priraďte technológie k ich charakteristikám</p>
                        </div>
                        <div>
                            <button class="btn btn-primary" onclick="startStudentGame('memory')">Hrať</button>
                        </div>
                    </div>
                    <div class="game-item">
                        <div class="game-info">
                            <h4>Klasifikácia procesov</h4>
                            <p>Zatrieďte technológie do správnych kategórií</p>
                        </div>
                        <div>
                            <button class="btn btn-primary" onclick="startStudentGame('classification')">Hrať</button>
                        </div>
                    </div>
                    <div class="game-item">
                        <div class="game-info">
                            <h4>Energetická náročnosť</h4>
                            <p>Usporiadajte technológie podľa spotreby energie</p>
                        </div>
                        <div>
                            <button class="btn btn-primary" onclick="startStudentGame('sequence')">Hrať</button>
                        </div>
                    </div>
                </div>

                <div class="results-table">
                    <h3>Moje výsledky</h3>
                    <table id="student-results-table">
                        <thead>
                            <tr>
                                <th>Dátum</th>
                                <th>Hra</th>
                                <th>Skóre</th>
                                <th>Čas</th>
                                <th>Hodnocenie</th>
                            </tr>
                        </thead>
                        <tbody id="student-results-tbody">
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Teacher Dashboard -->
            <div id="teacher-dashboard" class="dashboard">
                <div class="cards-grid">
                    <div class="card">
                        <h3>Registrovaní študenti</h3>
                        <div class="stat-number" id="total-students">0</div>
                        <p>Aktívnych účtov</p>
                    </div>
                    <div class="card">
                        <h3>Odohratých hier</h3>
                        <div class="stat-number" id="total-games">0</div>
                        <p>Celkový počet</p>
                    </div>
                    <div class="card">
                        <h3>Priemerná úspešnosť</h3>
                        <div class="stat-number" id="avg-success">0%</div>
                        <p>Zo všetkých študentov</p>
                    </div>
                </div>

                <div class="results-table">
                    <h3>Výsledky študentov</h3>
                    
                    <div class="filters">
                        <div class="filter-group">
                            <label>Študent:</label>
                            <select id="student-filter" onchange="filterResults()">
                                <option value="">Všetci študenti</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>Hra:</label>
                            <select id="game-filter" onchange="filterResults()">
                                <option value="">Všetky hry</option>
                                <option value="quiz">Kvíz</option>
                                <option value="memory">Pexeso</option>
                                <option value="classification">Klasifikácia</option>
                                <option value="sequence">Seradenie</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>Dátum od:</label>
                            <input type="date" id="date-filter" onchange="filterResults()">
                        </div>
                        <div class="filter-group">
                            <label>&nbsp;</label>
                            <button class="btn btn-secondary" onclick="exportResults()">Export CSV</button>
                        </div>
                    </div>

                    <table id="teacher-results-table">
                        <thead>
                            <tr>
                                <th>Študent</th>
                                <th>Hra</th>
                                <th>Dátum</th>
                                <th>Skóre</th>
                                <th>Čas</th>
                                <th>Hodnocenie</th>
                                <th>Detaily</th>
                            </tr>
                        </thead>
                        <tbody id="teacher-results-tbody">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Game Modal -->
    <div id="game-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000;">
        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; border-radius: 15px; padding: 30px; max-width: 90%; max-height: 90%; overflow: auto;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 id="game-modal-title">Hra</h2>
                <button onclick="closeGameModal()" style="background: #f44336; color: white; border: none; border-radius: 50%; width: 40px; height: 40px; cursor: pointer; font-size: 1.2rem;">×</button>
            </div>
            <div id="game-modal-content">
                <!-- Game content will be loaded here -->
            </div>
        </div>
    </div>

    <script>
        // Simulovaná databáza (v reálnej aplikácii by to bola skutočná databáza)
        let database = {
            users: [
                {
                    id: 1,
                    name: "Ing. Peter Novák",
                    email: "teacher@vste.sk",
                    password: "heslo123",
                    role: "teacher"
                },
                {
                    id: 2,
                    name: "Ján Študent",
                    email: "student@vste.sk", 
                    password: "heslo123",
                    role: "student"
                }
            ],
            results: [
                {
                    id: 1,
                    studentId: 2,
                    studentName: "Ján Študent",
                    game: "quiz",
                    score: 83,
                    maxScore: 100,
                    time: 180,
                    date: new Date('2024-01-15').toISOString(),
                    details: "Správne odpovedané 5 z 6 otázok"
                },
                {
                    id: 2,
                    studentId: 2,
                    studentName: "Ján Študent", 
                    game: "memory",
                    score: 100,
                    maxScore: 100,
                    time: 120,
                    date: new Date('2024-01-16').toISOString(),
                    details: "Všetky páry nájdené za 2:00 min, 24 ťahov"
                }
            ]
        };

        let currentUser = null;

        // Načítanie dát z localStorage
        function loadDatabase() {
            const saved = localStorage.getItem('progressiveTechDB');
            if (saved) {
                database = JSON.parse(saved);
            }
        }

        // Uloženie dát do localStorage
        function saveDatabase() {
            localStorage.setItem('progressiveTechDB', JSON.stringify(database));
        }

        // Autentifikácia
        function switchAuthTab(tab) {
            document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
            document.querySelector(`[onclick="switchAuthTab('${tab}')"]`).classList.add('active');
            
            if (tab === 'login') {
                document.getElementById('login-form').classList.remove('hidden');
                document.getElementById('register-form').classList.add('hidden');
            } else {
                document.getElementById('login-form').classList.add('hidden');
                document.getElementById('register-form').classList.remove('hidden');
            }
        }

        function login(event) {
            event.preventDefault();
            
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            const user = database.users.find(u => u.email === email && u.password === password);
            
            if (user) {
                currentUser = user;
                showDashboard();
                showAlert('Úspešne prihlásený!', 'success');
            } else {
                showAlert('Nesprávne prihlasovacie údaje!', 'danger');
            }
        }

        function register(event) {
            event.preventDefault();
            
            const name = document.getElementById('reg-name').value;
            const email = document.getElementById('reg-email').value;
            const password = document.getElementById('reg-password').value;
            const role = document.getElementById('reg-role').value;
            
            // Kontrola existencie emailu
            if (database.users.find(u => u.email === email)) {
                showAlert('Používateľ s týmto emailom už existuje!', 'danger');
                return;
            }
            
            // Vytvorenie nového používateľa
            const newUser = {
                id: database.users.length + 1,
                name,
                email,
                password,
                role
            };
            
            database.users.push(newUser);
            saveDatabase();
            
            currentUser = newUser;
            showDashboard();
            showAlert('Registrácia úspešná!', 'success');
        }

        function logout() {
            currentUser = null;
            document.getElementById('auth-section').style.display = 'block';
            document.getElementById('main-dashboard').classList.remove('active');
        }

        function showDashboard() {
            document.getElementById('auth-section').style.display = 'none';
            document.getElementById('main-dashboard').classList.add('active');
            
            document.getElementById('user-name').textContent = currentUser.name;
            document.getElementById('user-role').textContent = currentUser.role === 'teacher' ? 'Učiteľ' : 'Študent';
            document.getElementById('user-role').className = currentUser.role === 'teacher' ? 'role-badge role-teacher' : 'role-badge role-student';
            
            if (currentUser.role === 'teacher') {
                showTeacherDashboard();
            } else {
                showStudentDashboard();
            }
        }

        function showStudentDashboard() {
            document.getElementById('teacher-dashboard').classList.remove('active');
            document.getElementById('student-dashboard').classList.add('active');
            
            updateStudentStats();
            loadStudentResults();
        }

        function showTeacherDashboard() {
            document.getElementById('student-dashboard').classList.remove('active');
            document.getElementById('teacher-dashboard').classList.add('active');
            
            updateTeacherStats();
            loadTeacherResults();
            populateStudentFilter();
        }

        function updateStudentStats() {
            const studentResults = database.results.filter(r => r.studentId === currentUser.id);
            
            document.getElementById('student-games-played').textContent = studentResults.length;
            
            if (studentResults.length > 0) {
                const avgScore = studentResults.reduce((sum, r) => sum + (r.score / r.maxScore * 100), 0) / studentResults.length;
                const bestScore = Math.max(...studentResults.map(r => r.score / r.maxScore * 100));
                
                document.getElementById('student-avg-score').textContent = Math.round(avgScore) + '%';
                document.getElementById('student-best-score').textContent = Math.round(bestScore) + '%';
            }
        }

        function updateTeacherStats() {
            const students = database.users.filter(u => u.role === 'student');
            const allResults = database.results;
            
            document.getElementById('total-students').textContent = students.length;
            document.getElementById('total-games').textContent = allResults.length;
            
            if (allResults.length > 0) {
                const avgSuccess = allResults.reduce((sum, r) => sum + (r.score / r.maxScore * 100), 0) / allResults.length;
                document.getElementById('avg-success').textContent = Math.round(avgSuccess) + '%';
            }
        }

        function loadStudentResults() {
            const tbody = document.getElementById('student-results-tbody');
            const studentResults = database.results
                .filter(r => r.studentId === currentUser.id)
                .sort((a, b) => new Date(b.date) - new Date(a.date));
            
            tbody.innerHTML = studentResults.map(result => {
                const percentage = Math.round((result.score / result.maxScore) * 100);
                const badgeClass = percentage >= 80 ? 'score-excellent' : percentage >= 60 ? 'score-good' : 'score-poor';
                const gameNames = {
                    quiz: 'Kvíz',
                    memory: 'Pexeso', 
                    classification: 'Klasifikácia',
                    sequence: 'Seradenie'
                };
                
                return `
                    <tr>
                        <td>${new Date(result.date).toLocaleDateString('sk-SK')}</td>
                        <td>${gameNames[result.game] || result.game}</td>
                        <td>${result.score}/${result.maxScore}</td>
                        <td>${formatTime(result.time)}</td>
                        <td><span class="score-badge ${badgeClass}">${percentage}%</span></td>
                    </tr>
                `;
            }).join('');
        }

        function loadTeacherResults() {
            const tbody = document.getElementById('teacher-results-tbody');
            const allResults = database.results.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            displayResults(allResults);
        }

        function displayResults(results) {
            const tbody = document.getElementById('teacher-results-tbody');
            const gameNames = {
                quiz: 'Kvíz',
                memory: 'Pexeso',
                classification: 'Klasifikácia', 
                sequence: 'Seradenie'
            };
            
            tbody.innerHTML = results.map(result => {
                const percentage = Math.round((result.score / result.maxScore) * 100);
                const badgeClass = percentage >= 80 ? 'score-excellent' : percentage >= 60 ? 'score-good' : 'score-poor';
                
                return `
                    <tr>
                        <td>${result.studentName}</td>
                        <td>${gameNames[result.game] || result.game}</td>
                        <td>${new Date(result.date).toLocaleDateString('sk-SK')}</td>
                        <td>${result.score}/${result.maxScore}</td>
                        <td>${formatTime(result.time)}</td>
                        <td><span class="score-badge ${badgeClass}">${percentage}%</span></td>
                        <td>${result.details}</td>
                    </tr>
                `;
            }).join('');
        }

        function populateStudentFilter() {
            const select = document.getElementById('student-filter');
            const students = database.users.filter(u => u.role === 'student');
            
            select.innerHTML = '<option value="">Všetci študenti</option>' + 
                students.map(student => `<option value="${student.id}">${student.name}</option>`).join('');
        }

        function filterResults() {
            const studentFilter = document.getElementById('student-filter').value;
            const gameFilter = document.getElementById('game-filter').value;
            const dateFilter = document.getElementById('date-filter').value;
            
            let filteredResults = database.results;
            
            if (studentFilter) {
                filteredResults = filteredResults.filter(r => r.studentId == studentFilter);
            }
            
            if (gameFilter) {
                filteredResults = filteredResults.filter(r => r.game === gameFilter);
            }
            
            if (dateFilter) {
                filteredResults = filteredResults.filter(r => new Date(r.date) >= new Date(dateFilter));
            }
            
            displayResults(filteredResults);
        }

        function exportResults() {
            const results = database.results;
            const gameNames = {
                quiz: 'Kvíz',
                memory: 'Pexeso',
                classification: 'Klasifikácia',
                sequence: 'Seradenie'
            };
            
            let csv = 'Študent,Hra,Dátum,Skóre,Max Skóre,Percentá,Čas,Detaily\n';
            
            results.forEach(result => {
                const percentage = Math.round((result.score / result.maxScore) * 100);
                csv += `"${result.studentName}","${gameNames[result.game]}","${new Date(result.date).toLocaleDateString('sk-SK')}",${result.score},${result.maxScore},${percentage}%,"${formatTime(result.time)}","${result.details}"\n`;
            });
            
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', 'vysledky_studentov.csv');
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Spustenie hry pre študenta
        function startStudentGame(gameType) {
            const gameNames = {
                quiz: 'Kvíz - Základné pojmy',
                memory: 'Pexeso - Technológie',
                classification: 'Klasifikácia procesov', 
                sequence: 'Energetická náročnosť'
            };
            
            document.getElementById('game-modal-title').textContent = gameNames[gameType];
            document.getElementById('game-modal-content').innerHTML = `
                <p>Hra sa načítava...</p>
                <div style="text-align: center; margin: 20px;">
                    <button class="btn btn-primary" onclick="simulateGamePlay('${gameType}')">Simulovať hranie hry</button>
                </div>
                <p><small>Poznámka: V plnej verzii by sa tu načítala skutočná hra z predchádzajúceho artefaktu.</small></p>
            `;
            document.getElementById('game-modal').style.display = 'block';
        }

        function simulateGamePlay(gameType) {
            // Simulácia výsledku hry
            const scores = {
                quiz: { min: 50, max: 100, maxScore: 100 },
                memory: { min: 70, max: 100, maxScore: 100 },
                classification: { min: 60, max: 100, maxScore: 100 },
                sequence: { min: 40, max: 100, maxScore: 100 }
            };
            
            const gameConfig = scores[gameType];
            const score = Math.floor(Math.random() * (gameConfig.max - gameConfig.min + 1)) + gameConfig.min;
            const time = Math.floor(Math.random() * 300) + 60; // 1-5 minút
            
            const details = generateGameDetails(gameType, score, gameConfig.maxScore);
            
            // Uloženie výsledku
            const newResult = {
                id: database.results.length + 1,
                studentId: currentUser.id,
                studentName: currentUser.name,
                game: gameType,
                score: score,
                maxScore: gameConfig.maxScore,
                time: time,
                date: new Date().toISOString(),
                details: details
            };
            
            database.results.push(newResult);
            saveDatabase();
            
            // Aktualizácia zobrazenia
            updateStudentStats();
            loadStudentResults();
            
            // Zatvorenie modálu
            closeGameModal();
            
            const percentage = Math.round((score / gameConfig.maxScore) * 100);
            showAlert(`Hra dokončená! Vaše skóre: ${score}/${gameConfig.maxScore} (${percentage}%)`, 'success');
        }

        function generateGameDetails(gameType, score, maxScore) {
            const percentage = Math.round((score / maxScore) * 100);
            
            switch(gameType) {
                case 'quiz':
                    const correct = Math.round((score / maxScore) * 6);
                    return `Správne odpovedané ${correct} z 6 otázok`;
                case 'memory':
                    const moves = Math.floor(Math.random() * 20) + 16;
                    return `Všetky páry nájdené, ${moves} ťahov`;
                case 'classification':
                    const correctItems = Math.round((score / maxScore) * 12);
                    return `Správne zaradené ${correctItems} z 12 technológií`;
                case 'sequence':
                    const correctOrder = Math.round((score / maxScore) * 7);
                    return `Správne usporiadané ${correctOrder} z 7 technológií`;
                default:
                    return `Skóre: ${percentage}%`;
            }
        }

        function closeGameModal() {
            document.getElementById('game-modal').style.display = 'none';
        }

        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }

        function showAlert(message, type) {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            alertDiv.textContent = message;
            
            const container = document.querySelector('.container');
            container.insertBefore(alertDiv, container.firstChild);
            
            setTimeout(() => {
                alertDiv.remove();
            }, 5000);
        }

        // Inicializácia aplikácie
        function initApp() {
            loadDatabase();
            
            // Automatické prihlásenie ak je používateľ uložený
            const savedUser = localStorage.getItem('currentUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showDashboard();
            }
        }

        // Event listenery
        window.addEventListener('beforeunload', () => {
            if (currentUser) {
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
            }
        });

        // Spustenie aplikácie
        initApp();
    </script>
</body>
</html>